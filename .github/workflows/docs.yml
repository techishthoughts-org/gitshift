---
name: 📚 Documentation Validation
on:
  push:
    branches: [main]
    paths: [docs/**, README.md, .github/workflows/docs.yml]
  workflow_dispatch:
env:
  GO_VERSION: '1.23'
jobs:
  # 📚 Documentation Validation
  docs-validation:
    name: 📚 Validate Documentation
    runs-on: ubuntu-latest
    steps:
      - name: 📥 Checkout Code
        uses: actions/checkout@v4
      - name: 🔍 Check Markdown Links
        uses: gaurav-nelson/github-action-markdown-link-check@v1
        with:
          use-quiet-mode: 'yes'
          use-verbose-mode: 'yes'
          config-file: .github/markdown-link-check.json
          folder-path: docs/
      - name: 📝 Check Documentation Structure
        run: |
          echo "Validating documentation structure..."

          # Check if all required docs exist
          required_docs=("README.md" "docs/USER_GUIDE.md" "docs/CONFIGURATION.md" "docs/TROUBLESHOOTING.md" "docs/ARCHITECTURE.md" "docs/SECURITY.md" "docs/CONTRIBUTING.md")
          for doc in "${required_docs[@]}"; do
            if [ -f "$doc" ]; then
              echo "✅ $doc exists"
            else
              echo "❌ $doc missing"
              exit 1
            fi
          done
          echo "✅ All required documentation files present"
      - name: 📊 Documentation Metrics
        run: |
          echo "## 📚 Documentation Metrics" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          # Count documentation files
          DOC_COUNT=$(find docs/ -name "*.md" | wc -l)
          echo "**Documentation Files**: $DOC_COUNT" >> $GITHUB_STEP_SUMMARY

          # Count total lines in documentation
          DOC_LINES=$(find docs/ -name "*.md" -exec wc -l {} + | tail -1 | awk '{print $1}')
          echo "**Total Documentation Lines**: $DOC_LINES" >> $GITHUB_STEP_SUMMARY

          # Count README lines
          README_LINES=$(wc -l < README.md)
          echo "**README Lines**: $README_LINES" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### 📋 Documentation Coverage" >> $GITHUB_STEP_SUMMARY
          echo "- ✅ User Guide" >> $GITHUB_STEP_SUMMARY
          echo "- ✅ Configuration Guide" >> $GITHUB_STEP_SUMMARY
          echo "- ✅ Troubleshooting Guide" >> $GITHUB_STEP_SUMMARY
          echo "- ✅ Architecture Guide" >> $GITHUB_STEP_SUMMARY
          echo "- ✅ Security Guide" >> $GITHUB_STEP_SUMMARY
          echo "- ✅ Contributing Guide" >> $GITHUB_STEP_SUMMARY
