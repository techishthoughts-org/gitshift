---
name: ðŸ“š Documentation Validation
on:
  push:
    branches: [main]
    paths: [docs/**, README.md, .github/workflows/docs.yml]
  workflow_dispatch:
env:
  GO_VERSION: '1.23'
jobs:
  # ðŸ“š Documentation Validation
  docs-validation:
    name: ðŸ“š Validate Documentation
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ“¥ Checkout Code
        uses: actions/checkout@v4
      - name: ðŸ” Check Markdown Links
        uses: gaurav-nelson/github-action-markdown-link-check@v1
        with:
          use-quiet-mode: 'yes'
          use-verbose-mode: 'yes'
          config-file: .github/markdown-link-check.json
          folder-path: docs/
      - name: ðŸ“ Check Documentation Structure
        run: |
          echo "Validating documentation structure..."

          # Check if all required docs exist
          required_docs=("README.md" "docs/USER_GUIDE.md" "docs/CONFIGURATION.md" "docs/TROUBLESHOOTING.md" "docs/ARCHITECTURE.md" "docs/SECURITY.md" "docs/CONTRIBUTING.md")
          for doc in "${required_docs[@]}"; do
            if [ -f "$doc" ]; then
              echo "âœ… $doc exists"
            else
              echo "âŒ $doc missing"
              exit 1
            fi
          done
          echo "âœ… All required documentation files present"
      - name: ðŸ“Š Documentation Metrics
        run: |
          echo "## ðŸ“š Documentation Metrics" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY

          # Count documentation files
          DOC_COUNT=$(find docs/ -name "*.md" | wc -l)
          echo "**Documentation Files**: $DOC_COUNT" >> $GITHUB_STEP_SUMMARY

          # Count total lines in documentation
          DOC_LINES=$(find docs/ -name "*.md" -exec wc -l {} + | tail -1 | awk '{print $1}')
          echo "**Total Documentation Lines**: $DOC_LINES" >> $GITHUB_STEP_SUMMARY

          # Count README lines
          README_LINES=$(wc -l < README.md)
          echo "**README Lines**: $README_LINES" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ðŸ“‹ Documentation Coverage" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… User Guide" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… Configuration Guide" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… Troubleshooting Guide" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… Architecture Guide" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… Security Guide" >> $GITHUB_STEP_SUMMARY
          echo "- âœ… Contributing Guide" >> $GITHUB_STEP_SUMMARY
